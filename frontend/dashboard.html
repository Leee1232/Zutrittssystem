<!DOCTYPE html>
<html lang="de">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zweig und Klasse auswählen</title>
</head>

<body>
    <h1>Zweig und Klasse auswählen</h1>
    <form id="selection-form" method="GET" action="students.html">
        <label for="branch">Zweig auswählen:</label>
        <select id="branch" name="branch" required>
            <option value="">-- Wähle einen Zweig --</option>
        </select>
        <br><br>
        <label for="class">Klasse auswählen:</label>
        <select id="class" name="class" required disabled>
            <option value="">-- Wähle einen Zweig zuerst --</option>
        </select>
        <br><br>
        <button type="submit">Suchen</button>
    </form>

    <script>
        // API-Endpunkt für Zweige und Klassen
        const apiBase = "http://localhost:3000/api"; // Dummy-API

        const branchSelect = document.getElementById("branch");
        const classSelect = document.getElementById("class");

        // Lade Zweige
        fetch(`${apiBase}/branches`)
            .then(response => response.json())
            .then(data => {
                data.forEach(branch => {
                    const option = document.createElement("option");
                    option.value = branch.id;
                    option.textContent = branch.name;
                    branchSelect.appendChild(option);
                });
            });

        // Lade Klassen basierend auf dem ausgewählten Zweig
        branchSelect.addEventListener("change", () => {
            const branchId = branchSelect.value;
            classSelect.innerHTML = '<option value="">-- Wähle eine Klasse --</option>';
            classSelect.disabled = !branchId;

            if (branchId) {
                fetch(`${apiBase}/branches/${branchId}/classes`)
                    .then(response => response.json())
                    .then(data => {
                        data.forEach(klass => {
                            const option = document.createElement("option");
                            option.value = klass.id;
                            option.textContent = klass.name;
                            classSelect.appendChild(option);
                        });
                    });
            }
        });
    </script>
</body>

</html>